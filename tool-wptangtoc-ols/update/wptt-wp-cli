#!/bin/bash
# @author: Gia Tu·∫•n
# @website: https://wptangtoc.com
# @email: giatuan@wptangtoc.com
# @since: 2025

function huong_dan(){
t√≠nh nƒÉng c·∫≠p nh·∫≠t WP-CLI th√¨ ƒë√¢y l√† m·ªôt ch·ª©c nƒÉng ti·ªán √≠ch gi√∫p b·∫°n d·ªÖ d√†ng n√¢ng c·∫•p WP-CLI [WordPress Command-Line Interface] l√™n phi√™n b·∫£n m·ªõi nh·∫•t ngay tr√™n m√°y ch·ªß c·ªßa m√¨nh.

üéØ M·ª•c ƒë√≠ch c·ªßa t√≠nh nƒÉng c·∫≠p nh·∫≠t WP-CLI:
 * S·ª≠ d·ª•ng T√≠nh nƒÉng M·ªõi: WP-CLI li√™n t·ª•c ƒë∆∞·ª£c ph√°t tri·ªÉn. C√°c b·∫£n c·∫≠p nh·∫≠t mang ƒë·∫øn c√°c l·ªánh m·ªõi, t√πy ch·ªçn m·ªõi v√† c·∫£i ti·∫øn hi·ªáu su·∫•t, gi√∫p b·∫°n qu·∫£n l√Ω WordPress hi·ªáu qu·∫£ h∆°n.
 * V√° l·ªói & TƒÉng ·ªîn ƒë·ªãnh: C√°c phi√™n b·∫£n m·ªõi s·ª≠a c√°c l·ªói ƒë∆∞·ª£c ph√°t hi·ªán trong c√°c phi√™n b·∫£n c≈©, gi√∫p WP-CLI ho·∫°t ƒë·ªông ·ªïn ƒë·ªãnh v√† ƒë√°ng tin c·∫≠y h∆°n.
 * B·∫£o m·∫≠t: ƒê√¥i khi, c√°c b·∫£n c·∫≠p nh·∫≠t c≈©ng bao g·ªìm c√°c b·∫£n v√° b·∫£o m·∫≠t cho ch√≠nh c√¥ng c·ª• WP-CLI.
 * ƒê·∫£m b·∫£o T∆∞∆°ng th√≠ch: Gi·ªØ cho WP-CLI t∆∞∆°ng th√≠ch t·ªët nh·∫•t v·ªõi c√°c phi√™n b·∫£n WordPress m·ªõi nh·∫•t, PHP v√† m√¥i tr∆∞·ªùng m√°y ch·ªß.

T√≥m l·∫°i: T√≠nh nƒÉng c·∫≠p nh·∫≠t WP-CLI trong WPTangToc OLS l√† m·ªôt ti·ªán √≠ch gi√∫p b·∫°n ƒë·∫£m b·∫£o r·∫±ng c√¥ng c·ª• d√≤ng l·ªánh WP-CLI tr√™n m√°y ch·ªß c·ªßa m√¨nh lu√¥n l√† phi√™n b·∫£n m·ªõi nh·∫•t, gi√∫p b·∫°n ti·∫øp c·∫≠n c√°c t√≠nh nƒÉng, b·∫£n v√° l·ªói v√† c·∫£i ti·∫øn b·∫£o m·∫≠t m·ªõi nh·∫•t m·ªôt c√°ch d·ªÖ d√†ng.
}

echo ""
echo ""
echo ""
echo "========================================================================="
echo "|Qu·∫£n l√Ω c·∫≠p nh·∫≠t Update => C·∫≠p nh·∫≠t WP-CLI                             |"
echo "========================================================================="
echo ""
echo ""

if [[ ! $(which wp) ]];then
	echo "Ti·∫øn h√†nh c√†i ƒë·∫∑t WP CLI"
	curl -O https://raw.githubusercontent.com/wp-cli/builds/gh-pages/phar/wp-cli.phar
	chmod +x wp-cli.phar
	mv wp-cli.phar /usr/local/bin/wp
	if [[ ! $(which wp) ]];then
		curl -O https://raw.githubusercontent.com/wp-cli/builds/gh-pages/phar/wp-cli.phar
		chmod +x wp-cli.phar
		mv wp-cli.phar /usr/bin/wp
	fi
	if [[ $(which wp) ]];then
		echo "ƒê√£ ti·ªÅn h√†nh c√†i ƒë·∫∑t WP CLI th√†nh c√¥ng"
	else
		echo "C√†i ƒë·∫∑t WP CLI Th·∫•t b·∫°i"
	fi
	. /etc/wptt/wptt-update-main 1
fi

version=$(wp --info | grep 'WP-CLI version' | cut -f2 -d ':')
echo "Phi√™n b·∫£n WP CLI hi·ªán t·∫°i c·ªßa b·∫°n l√†: version $version"
echo "ƒêang ti·∫øn h√†nh c·∫≠p nh·∫≠t WP CLI vui l√≤ng ƒë·ª£i..."
wp cli update
version2=$(wp --info | grep 'WP-CLI version' | cut -f2 -d ':')
if [[ "$version" = "$version2" ]]; then
	echo "Hi·ªán t·∫°i b·∫°n ƒë√£ s·ª≠ d·ª•ng phi√™n b·∫£n WP CLI m·ªõi nh·∫•t r·ªìi"
else
	. /etc/wptt/echo-color
    echoDone "C·∫≠p nh·∫≠t th√†nh c√¥ng WP CLI l√™n phi√™n b·∫£n $version2"
fi

check_menu_wptangtoc_active=$1
if [[ $check_menu_wptangtoc_active = "98" ]];then
. /etc/wptt/wptt-update-main 1
fi

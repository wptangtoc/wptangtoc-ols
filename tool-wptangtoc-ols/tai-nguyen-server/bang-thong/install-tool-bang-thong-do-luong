#!/bin/bash

function huong_dan(){
WPTangToc OLS cÃ³ tÃ­nh nÄƒng KÃ­ch hoáº¡t / Há»§y kÃ­ch hoáº¡t theo dÃµi bÄƒng thÃ´ng, thÃ¬ Ä‘Ã¢y lÃ  má»™t chá»©c nÄƒng giÃºp báº¡n báº­t hoáº·c táº¯t viá»‡c mÃ¡y chá»§ web OpenLiteSpeed [OLS] ghi láº¡i vÃ  tÃ­nh toÃ¡n lÆ°á»£ng dá»¯ liá»‡u [bandwidth] mÃ  cÃ¡c website cá»§a báº¡n sá»­ dá»¥ng.

ðŸŽ¯ Má»¥c Ä‘Ã­ch cá»§a tÃ­nh nÄƒng:
KÃ­ch hoáº¡t [Enable]:
 * GiÃ¡m sÃ¡t TÃ i nguyÃªn: GiÃºp báº¡n biáº¿t chÃ­nh xÃ¡c website nÃ o Ä‘ang sá»­ dá»¥ng bao nhiÃªu bÄƒng thÃ´ng. Äiá»u nÃ y ráº¥t quan trá»ng Ä‘á»ƒ phÃ¡t hiá»‡n cÃ¡c website tiÃªu tá»‘n nhiá»u tÃ i nguyÃªn hoáº·c cÃ³ lÆ°u lÆ°á»£ng truy cáº­p Ä‘á»™t biáº¿n.
 * Quáº£n lÃ½ Chi phÃ­: Náº¿u gÃ³i VPS cá»§a báº¡n cÃ³ giá»›i háº¡n bÄƒng thÃ´ng, viá»‡c theo dÃµi giÃºp báº¡n trÃ¡nh vÆ°á»£t má»©c vÃ  phÃ¡t sinh chi phÃ­ khÃ´ng mong muá»‘n.
 * PhÃ¢n tÃ­ch LÆ°u lÆ°á»£ng: Dá»¯ liá»‡u bÄƒng thÃ´ng cung cáº¥p cÃ¡i nhÃ¬n sÃ¢u hÆ¡n vá» hoáº¡t Ä‘á»™ng cá»§a website, vÃ­ dá»¥: cÃ¡c tá»‡p tin lá»›n nÃ o Ä‘ang Ä‘Æ°á»£c táº£i nhiá»u.
 * Láº­p káº¿ hoáº¡ch NÃ¢ng cáº¥p: Dá»±a vÃ o xu hÆ°á»›ng sá»­ dá»¥ng bÄƒng thÃ´ng Ä‘á»ƒ quyáº¿t Ä‘á»‹nh khi nÃ o cáº§n nÃ¢ng cáº¥p mÃ¡y chá»§ hoáº·c gÃ³i hosting.

Há»§y kÃ­ch hoáº¡t [Disable]:
 * Giáº£m táº£i [Ráº¥t nhá»]: QuÃ¡ trÃ¬nh ghi nháº­n bÄƒng thÃ´ng cÃ³ thá»ƒ táº¡o ra má»™t lÆ°á»£ng táº£i xá»­ lÃ½ vÃ  I/O ráº¥t nhá» trÃªn mÃ¡y chá»§. Máº·c dÃ¹ thÆ°á»ng khÃ´ng Ä‘Ã¡ng ká»ƒ, má»™t sá»‘ ngÆ°á»i muá»‘n táº¯t má»i thá»© khÃ´ng tháº­t sá»± cáº§n thiáº¿t Ä‘á»ƒ tá»‘i Æ°u hÃ³a tá»‘i Ä‘a.
 * TrÃ¡nh Redundancy: Náº¿u báº¡n Ä‘Ã£ sá»­ dá»¥ng cÃ¡c cÃ´ng cá»¥ khÃ¡c Ä‘á»ƒ theo dÃµi bÄƒng thÃ´ng [vÃ­ dá»¥: tá»« nhÃ  cung cáº¥p hosting, Cloudflare, hoáº·c cÃ¡c pháº§n má»m giÃ¡m sÃ¡t khÃ¡c], báº¡n cÃ³ thá»ƒ muá»‘n táº¯t tÃ­nh nÄƒng nÃ y trong OLS Ä‘á»ƒ trÃ¡nh theo dÃµi trÃ¹ng láº·p.
 * Tiáº¿t kiá»‡m dung lÆ°á»£ng lÆ°u trá»¯ [Ráº¥t nhá»]: Dá»¯ liá»‡u bÄƒng thÃ´ng cÃ³ thá»ƒ Ä‘Æ°á»£c lÆ°u láº¡i, viá»‡c táº¯t Ä‘i sáº½ tiáº¿t kiá»‡m má»™t chÃºt khÃ´ng gian.

TÃ³m láº¡i: TÃ­nh nÄƒng nÃ y trong WPTangToc OLS cung cáº¥p cho báº¡n quyá»n kiá»ƒm soÃ¡t viá»‡c OpenLiteSpeed cÃ³ ghi nháº­n vÃ  thá»‘ng kÃª dung lÆ°á»£ng bÄƒng thÃ´ng mÃ  cÃ¡c website sá»­ dá»¥ng hay khÃ´ng. Viá»‡c kÃ­ch hoáº¡t giÃºp báº¡n giÃ¡m sÃ¡t vÃ  quáº£n lÃ½ tÃ i nguyÃªn tá»‘t hÆ¡n, trong khi viá»‡c há»§y kÃ­ch hoáº¡t cÃ³ thá»ƒ há»¯u Ã­ch náº¿u báº¡n Ä‘Ã£ cÃ³ giáº£i phÃ¡p theo dÃµi khÃ¡c hoáº·c muá»‘n giáº£m thiá»ƒu má»i táº£i khÃ´ng cáº§n thiáº¿t trÃªn server.
}

. /etc/wptt/.wptt.conf
if [[ $ngon_ngu = '' ]];then
	ngon_ngu='vi'
fi
. /etc/wptt/lang/$ngon_ngu.sh

. /etc/wptt/echo-color

if [[ $(which vnstat 2>/dev/null) ]];then
vnstat_check='on'
else
vnstat_check='off'
fi

if [[ $vnstat_check = 'off' ]];then
echo -e "$xac_nhan $cai tool $quan_ly_bang_thong ?: "
	prompt="$nhap_lua_chon_cua_ban [1-2]: "
	dongy="n"
	options=("$dong_y" "$khong_dong_y")
	PS3="$prompt"
	select opt in "${options[@]}"; do
		case "$REPLY" in
			1)
				dongy="y"
				break
				;;

			2)
				dongy="n"
				break
				;;

			$((${#options[@]} + 1)))
				printf "\n$ban_nhap_sai_he_thong_se_chon_khong_dong_y\n"
				break
				;;
			*)
				printf "$ban_nhap_sai_he_thong_se_chon_khong_dong_y\n"
				break
				;;
		esac
	done


	if [[ "$dongy" = 'y' ]]; then
	_runing "$cai $quan_ly_bang_thong"
dnf install vnstat -y >/dev/null 2>&1
systemctl start vnstat >/dev/null 2>&1
systemctl enable vnstat >/dev/null 2>&1
	_rundone "$cai $quan_ly_bang_thong"
fi
. /etc/wptt/tai-nguyen-server/wptt-bang-thong-main 98
fi



if [[ $vnstat_check = 'on' ]];then
echo -e "$xac_nhan $tat tool $quan_ly_bang_thong ?: "
	prompt="$nhap_lua_chon_cua_ban [1-2]: "
	dongy="n"
	options=("$dong_y" "$khong_dong_y")
	PS3="$prompt"
	select opt in "${options[@]}"; do
		case "$REPLY" in
			1)
				dongy="y"
				break
				;;

			2)
				dongy="n"
				break
				;;

			$((${#options[@]} + 1)))
				printf "\n$ban_nhap_sai_he_thong_se_chon_khong_dong_y\n"
				break
				;;
			*)
				printf "$ban_nhap_sai_he_thong_se_chon_khong_dong_y\n"
				break
				;;
		esac
	done


	if [[ "$dongy" = 'y' ]]; then
	_runing "$tat $quan_ly_bang_thong"
dnf remove vnstat -y >/dev/null 2>&1
systemctl stop vnstat >/dev/null 2>&1
systemctl disable vnstat >/dev/null 2>&1
	_rundone "$tat $quan_ly_bang_thong"
fi
. /etc/wptt/tai-nguyen-server/wptt-bang-thong-main
fi


. /etc/wptt/tai-nguyen-server/wptt-bang-thong-main


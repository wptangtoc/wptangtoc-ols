#!/bin/bash

function huong_dan(){
WPTangToc OLS c√≥ t√≠nh nƒÉng ki·ªÉm tra dung l∆∞·ª£ng m√£ ngu·ªìn website, th√¨ ƒë√¢y l√† m·ªôt ch·ª©c nƒÉng ti·ªán √≠ch gi√∫p b·∫°n nhanh ch√≥ng xem ƒë∆∞·ª£c t·ªïng k√≠ch th∆∞·ªõc [dung l∆∞·ª£ng ƒëƒ©a] m√† th∆∞ m·ª•c c·ªßa m·ªôt website c·ª• th·ªÉ ƒëang chi·∫øm d·ª•ng tr√™n m√°y ch·ªß.

T√≠nh nƒÉng Ki·ªÉm tra Dung l∆∞·ª£ng M√£ ngu·ªìn Website [WPTangToc OLS]
üíæ M·ª•c ƒë√≠ch ch√≠nh:
 * Qu·∫£n l√Ω Dung l∆∞·ª£ng ƒêƒ©a: Gi√∫p b·∫°n theo d√µi xem website n√†o ƒëang chi·∫øm nhi·ªÅu kh√¥ng gian l∆∞u tr·ªØ nh·∫•t tr√™n m√°y ch·ªß, ƒë·∫∑c bi·ªát h·ªØu √≠ch khi dung l∆∞·ª£ng ƒëƒ©a c√≥ h·∫°n.
 * X√°c ƒë·ªãnh Website Ph√¨nh to: D·ªÖ d√†ng t√¨m ra c√°c website c√≥ dung l∆∞·ª£ng l·ªõn b·∫•t th∆∞·ªùng, c√≥ th·ªÉ do ch·ª©a nhi·ªÅu file ·∫£nh/video, file cache l·ªõn, ho·∫∑c c√°c file kh√¥ng c·∫ßn thi·∫øt.
 * H·ªó tr·ª£ D·ªçn d·∫πp: Cung c·∫•p th√¥ng tin ƒë·ªÉ b·∫°n quy·∫øt ƒë·ªãnh website n√†o c·∫ßn ƒë∆∞·ª£c d·ªçn d·∫πp [x√≥a file r√°c, t·ªëi ∆∞u ·∫£nh, x√≥a cache c≈©].
 * L·∫≠p k·∫ø ho·∫°ch Sao l∆∞u/Di chuy·ªÉn: Bi·∫øt ƒë∆∞·ª£c dung l∆∞·ª£ng gi√∫p b·∫°n ∆∞·ªõc t√≠nh th·ªùi gian v√† kh√¥ng gian c·∫ßn thi·∫øt cho vi·ªác sao l∆∞u ho·∫∑c di chuy·ªÉn website.

T√≥m l·∫°i: T√≠nh nƒÉng ki·ªÉm tra dung l∆∞·ª£ng m√£ ngu·ªìn website trong WPTangToc OLS l√† m·ªôt c√¥ng c·ª• h·ªØu √≠ch gi√∫p b·∫°n gi√°m s√°t v√† qu·∫£n l√Ω hi·ªáu qu·∫£ vi·ªác s·ª≠ d·ª•ng kh√¥ng gian l∆∞u tr·ªØ tr√™n m√°y ch·ªß cho t·ª´ng website WordPress, h·ªó tr·ª£ vi·ªác t·ªëi ∆∞u v√† b·∫£o tr√¨ h·ªá th·ªëng.
}


NAME=$1
if [[ $NAME = "98" ]];then
NAME=""
fi
if [[ $NAME = "" ]];then
echo ""
echo ""
echo ""

echo "========================================================================="
echo "|Qu·∫£n l√Ω m√£ ngu·ªìn => Ki·ªÉm tra dung l∆∞·ª£ng m√£ ngu·ªìn website               |"
echo "========================================================================="
echo ""
echo ""
. /etc/wptt/tenmien-them-lua-chon-tat-ca-website
echo ""
echo ""
echo "L·ª±a ch·ªçn website b·∫°n mu·ªën ki·∫øm tra dung l∆∞·ª£ng m√£ ngu·ªìn: "
echo ""
lua_chon_NAME
fi


if [[ $NAME = 'T·∫•t c·∫£ website' ]];then
	if [ "$(ls -A /etc/wptt/vhost| grep -v '^\.\.conf$' | sort -uV)" ]; then
		for entry in $(ls -A /etc/wptt/vhost|sort -uV); do
			domain=$(echo $entry | sed 's/^.//' | sed 's/.conf//')
			path_html="/usr/local/lsws/$domain/html"
			i=1
			if [[ -d "$path_html" ]]; then
				. /etc/wptt/ma-nguon/wptt-kiem-tra-dung-luong $domain
			fi
		done
	fi

	check_menu_wptangtoc_active=$1
	if [[ $check_menu_wptangtoc_active = "98" ]];then
    . /etc/wptt/wptt-ma-nguon-main 1
	fi

	exit
fi


if [[ "$NAME" = "0" || "$NAME" = "" ]]; then
    . /etc/wptt/wptt-ma-nguon-main 1
fi

pathcheck="/etc/wptt/vhost/.$NAME.conf"
if [[ ! -f "$pathcheck" ]]; then
    clear
	echoDo "T√™n mi·ªÅn kh√¥ng t·ªìn t·∫°i tr√™n h·ªá th·ªëng n√†y"
    sleep 3
    . /etc/wptt/wptt-ma-nguon-main 1
    exit
fi

kiemtra_dung_luong=''
kiemtra_dung_luong=$(du -hs /usr/local/lsws/$NAME/html | sed 's/\t//g'| cut -f1 -d '/')
echo "Dung l∆∞·ª£ng m√£ ngu·ªìn website $NAME l√† ${kiemtra_dung_luong}B"

check_menu_wptangtoc_active=$1
if [[ $check_menu_wptangtoc_active = "98" ]];then
. /etc/wptt/wptt-ma-nguon-main 1
fi

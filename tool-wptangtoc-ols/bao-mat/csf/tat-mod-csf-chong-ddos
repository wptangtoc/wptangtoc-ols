#!/bin/bash

function huong_dan(){
TÃ­nh nÄƒng Há»§y cÃ i Ä‘áº·t chá»‘ng DDoS CSF trong WPTangToc OLS lÃ  hÃ nh Ä‘á»™ng nháº±m Ä‘áº£o ngÆ°á»£c hoáº·c gá»¡ bá» cÃ¡c cáº¥u hÃ¬nh chuyÃªn biá»‡t vá» chá»‘ng DDoS Ä‘Ã£ Ä‘Æ°á»£c thiáº¿t láº­p cho tÆ°á»ng lá»­a CSF trÆ°á»›c Ä‘Ã³ [thÆ°á»ng lÃ  thÃ´ng qua chÃ­nh WPTangToc OLS]. Äiá»u quan trá»ng cáº§n lÆ°u Ã½ lÃ  tÃ­nh nÄƒng nÃ y thÆ°á»ng khÃ´ng gá»¡ bá» hoÃ n toÃ n tÆ°á»ng lá»­a CSF mÃ  chá»‰ Ä‘Æ°a cÃ¡c cÃ i Ä‘áº·t chá»‘ng DDoS cá»§a nÃ³ vá» tráº¡ng thÃ¡i máº·c Ä‘á»‹nh hoáº·c Ã­t nghiÃªm ngáº·t hÆ¡n.

ðŸŽ¯ Má»¥c Ä‘Ã­ch cá»§a viá»‡c há»§y cÃ i Ä‘áº·t chá»‘ng DDoS CSF
 * Kháº¯c phá»¥c sá»± cá»‘: Náº¿u cÃ¡c thiáº¿t láº­p chá»‘ng DDoS quÃ¡ nghiÃªm ngáº·t Ä‘ang vÃ´ tÃ¬nh cháº·n cÃ¡c truy cáº­p há»£p lá»‡ hoáº·c gÃ¢y ra cÃ¡c váº¥n Ä‘á» vá» hiá»‡u suáº¥t khÃ´ng mong muá»‘n.
 * Quay vá» cáº¥u hÃ¬nh CSF máº·c Ä‘á»‹nh: ÄÆ°a cÃ¡c thÃ´ng sá»‘ liÃªn quan Ä‘áº¿n chá»‘ng DDoS trong CSF [nhÆ° SYNFLOOD, CONNLIMIT, PORTFLOOD] trá»Ÿ láº¡i giÃ¡ trá»‹ gá»‘c cá»§a CSF khi chÆ°a Ä‘Æ°á»£c WPTangToc OLS tá»‘i Æ°u hÃ³a cho chá»‘ng DDoS.
 * Äiá»u chá»‰nh thá»§ cÃ´ng: NgÆ°á»i dÃ¹ng muá»‘n tá»± mÃ¬nh tinh chá»‰nh cÃ¡c cÃ i Ä‘áº·t chá»‘ng DDoS theo Ã½ muá»‘n sau khi Ä‘Ã£ thá»­ nghiá»‡m cÃ¡c cáº¥u hÃ¬nh tá»± Ä‘á»™ng.
 * Giáº£m bá»›t cÃ¡c háº¡n cháº¿: Khi khÃ´ng cÃ²n Æ°u tiÃªn cao viá»‡c chá»‘ng DDoS á»Ÿ má»©c Ä‘á»™ Ä‘Ã£ cÃ i Ä‘áº·t vÃ  muá»‘n há»‡ thá»‘ng thoÃ¡ng hÆ¡n má»™t chÃºt.

TÃ³m láº¡i, tÃ­nh nÄƒng Há»§y cÃ i Ä‘áº·t chá»‘ng DDoS CSF trong WPTangToc OLS cung cáº¥p má»™t cÃ¡ch Ä‘á»ƒ báº¡n dá»… dÃ ng quay láº¡i tráº¡ng thÃ¡i cáº¥u hÃ¬nh Ã­t nghiÃªm ngáº·t hÆ¡n cho cÃ¡c tÃ­nh nÄƒng chá»‘ng DDoS cá»§a tÆ°á»ng lá»­a CSF, mÃ  khÃ´ng cáº§n pháº£i gá»¡ bá» hoÃ n toÃ n CSF.
}


echo "========================================================================="
echo "|Quáº£n lÃ½ báº£o máº­t => CSF => Táº¯t chá»‘ng DDOS cháº¿ Ä‘á»™                        |"
echo "========================================================================="
. /etc/wptt/echo-color
if [ ! -f /etc/csf/csf.conf ]; then
	echoDo "Báº¡n chÆ°a cÃ i Ä‘áº·t CSF"
	. /etc/wptt/bao-mat/csf-main 1
fi

sed -i "/^SYNFLOOD/s/\"[^\"]*\"/\"0\"/1" /etc/csf/csf.conf
sed -i "/^CT_LIMIT/s/\"[^\"]*\"/\"0\"/1" /etc/csf/csf.conf
sed -i "/^CT_EMAIL_ALERT/s/\"[^\"]*\"/\"1\"/1" /etc/csf/csf.conf
sed -i "/^CT_PORTS/s/\"[^\"]*\"/\"\"/1" /etc/csf/csf.conf
sed -i "/^CONNLIMIT/s/\"[^\"]*\"/\"\"/1" /etc/csf/csf.conf


sed -i "/^UDPFLOOD /s/\"[^\"]*\"/\"0\"/1" /etc/csf/csf.conf
sed -i "/^UDPFLOOD_LIMIT/s/\"[^\"]*\"/\"100\/s\"/1" /etc/csf/csf.conf
sed -i "/^UDPFLOOD_BURST/s/\"[^\"]*\"/\"500\"/1" /etc/csf/csf.conf


sed -i "/^PORTFLOOD/s/\"[^\"]*\"/\"\"/1" /etc/csf/csf.conf

echo "Táº¯t mode chá»‘ng ddos CSF : $(date '+%d-%m-%Y %H:%M')" >> /var/log/wptangtoc-ols.log

csf -x >/dev/null 2>&1
csf -e >/dev/null 2>&1
systemctl restart csf
systemctl restart lfd

check_menu_wptangtoc_active=$1
if [[ $check_menu_wptangtoc_active = "98" ]];then
. /etc/wptt/bao-mat/csf-main 1
fi


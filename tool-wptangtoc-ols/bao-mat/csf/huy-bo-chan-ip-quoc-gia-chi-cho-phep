#!/bin/bash

function huong_dan(){
TÃ­nh nÄƒng Há»§y thiáº¿t láº­p cháº·n háº¿t quá»‘c gia ngoáº¡i trá»« quá»‘c gia cá»¥ thá»ƒ Ä‘Æ°á»£c phÃ©p CSF trong WPTangToc OLS lÃ  hÃ nh Ä‘á»™ng gá»¡ bá» cáº¥u hÃ¬nh tÆ°á»ng lá»­a CSF Ä‘ang hoáº¡t Ä‘á»™ng á»Ÿ cháº¿ Ä‘á»™ chá»‰ cho phÃ©p má»™t sá»‘ quá»‘c gia truy cáº­p.

Sau khi há»§y, mÃ¡y chá»§ cá»§a báº¡n sáº½ khÃ´ng cÃ²n tá»± Ä‘á»™ng cháº·n táº¥t cáº£ cÃ¡c quá»‘c gia khÃ´ng náº±m trong danh sÃ¡ch Ä‘Æ°á»£c phÃ©p trÆ°á»›c Ä‘Ã³ ná»¯a.

ðŸŽ¯ Má»¥c Ä‘Ã­ch cá»§a viá»‡c há»§y bá» cáº¥u hÃ¬nh nghiÃªm ngáº·t nÃ y
 * Má»Ÿ rá»™ng pháº¡m vi truy cáº­p: Khi báº¡n muá»‘n cho phÃ©p truy cáº­p tá»« nhiá»u quá»‘c gia hÆ¡n, khÃ´ng chá»‰ giá»›i háº¡n trong danh sÃ¡ch whitelist Ä‘Ã£ thiáº¿t láº­p.
 * Kháº¯c phá»¥c sá»± cá»‘ cháº·n nháº§m: Náº¿u cáº¥u hÃ¬nh chá»‰ cho phÃ©p Ä‘ang vÃ´ tÃ¬nh cháº·n cÃ¡c ngÆ°á»i dÃ¹ng há»£p lá»‡ hoáº·c cÃ¡c dá»‹ch vá»¥ quan trá»ng tá»« nhá»¯ng quá»‘c gia chÆ°a Ä‘Æ°á»£c thÃªm vÃ o danh sÃ¡ch.
 * Thay Ä‘á»•i chiáº¿n lÆ°á»£c kiá»ƒm soÃ¡t truy cáº­p: Quyáº¿t Ä‘á»‹nh chuyá»ƒn sang má»™t phÆ°Æ¡ng phÃ¡p Ã­t háº¡n cháº¿ hÆ¡n, vÃ­ dá»¥ nhÆ° khÃ´ng cháº·n theo quá»‘c gia ná»¯a, hoáº·c chuyá»ƒn sang sá»­ dá»¥ng danh sÃ¡ch cháº·n cá»¥ thá»ƒ [CC_DENY] thay vÃ¬ chá»‰ cho phÃ©p [CC_ALLOW].
 * ÄÆ¡n giáº£n hÃ³a láº¡i cáº¥u hÃ¬nh: Náº¿u viá»‡c duy trÃ¬ danh sÃ¡ch chá»‰ cho phÃ©p trá»Ÿ nÃªn phá»©c táº¡p hoáº·c khÃ´ng cÃ²n cáº§n thiáº¿t.

TÃ³m láº¡i, tÃ­nh nÄƒng nÃ y giÃºp báº¡n dá»… dÃ ng gá»¡ bá» chÃ­nh sÃ¡ch kiá»ƒm soÃ¡t truy cáº­p Ä‘á»‹a lÃ½ nghiÃªm ngáº·t chá»‰ cho phÃ©p má»™t sá»‘ quá»‘c gia, má»Ÿ cá»­a cho truy cáº­p tá»« nhiá»u khu vá»±c hÆ¡n, Ä‘á»“ng thá»i váº«n giá»¯ láº¡i cÃ¡c lá»›p báº£o vá»‡ khÃ¡c cá»§a tÆ°á»ng lá»­a CSF.
}


echo "========================================================================="
echo "|Quáº£n lÃ½ báº£o máº­t => CSF => Há»§y bá» cháº·n toÃ n bá»™ Quá»‘c gia chá»‰ cho phÃ©p má»™t sá»‘ quá»‘c gia|"
echo "========================================================================="

. /etc/wptt/echo-color
if [ ! -f /etc/csf/csf.conf ]; then
	echoDo "Báº¡n chÆ°a cÃ i Ä‘áº·t CSF"
	. /etc/wptt/bao-mat/csf-main 1
fi

countryblicklist=`grep "CC_ALLOW_FILTER =\ " /etc/csf/csf.conf | awk 'NR==1 {print $3}' | cut -d \" -f 2`
if [ "$countryblicklist" = "" ]; then
echo "========================================================================="
echo "Hien tai CSF Firewall khong block dat nuoc chÆ°a Ä‘Æ°á»£c thiáº¿t láº­p. "
echo "-------------------------------------------------------------------------"
. /etc/wptt/bao-mat/csf-main 1
fi
_runing "Táº¯t tÃ­nh nÄƒng cháº·n toÃ n bá»™ quá»‘c gia chá»‰ cho phÃ©p má»™t sá»‘ quá»‘c gia Ä‘Æ°á»£c truy cáº­p"
sed -i "s/.*CC_ALLOW_FILTER\ =.*/CC_ALLOW_FILTER = \"\"/g" /etc/csf/csf.conf
csf -x >/dev/null 2>&1
csf -e >/dev/null 2>&1
systemctl restart csf
systemctl restart lfd
_rundone "Táº¯t tÃ­nh nÄƒng cháº·n toÃ n bá»™ quá»‘c gia chá»‰ cho phÃ©p má»™t sá»‘ quá»‘c gia Ä‘Æ°á»£c truy cáº­p"

check_menu_wptangtoc_active=$1
if [[ $check_menu_wptangtoc_active = "98" ]];then
. /etc/wptt/bao-mat/csf-main 1
fi

